__set_project()
set_property(GLOBAL PROPERTY __PROJECT_DXCOMPILER_NAME ${PROJECT_NAME})
set_property(GLOBAL PROPERTY __PROJECT_DXCOMPILER_INCLUDE ${PROJECT_BINARY_DIR}/install/include)
set_property(GLOBAL PROPERTY __PROJECT_DXCOMPILER_LIB ${PROJECT_BINARY_DIR}/install/lib/zlib$<$<CONFIG:Debug>:d>${CMAKE_STATIC_LIBRARY_SUFFIX})

include(ExternalProject)

ExternalProject_Add(
    ${PROJECT_NAME}
    PREFIX ${PROJECT_BINARY_DIR}
    GIT_REPOSITORY https://github.com/microsoft/DirectXShaderCompiler.git
    GIT_TAG v1.4.1907
    GIT_SHALLOW 1
    GIT_PROGRESS 1
    TMP_DIR tmp
    STAMP_DIR stamp
    DOWNLOAD_DIR download
    INSTALL_DIR install
    SOURCE_DIR src
    BINARY_DIR ${__BUILD_DIR}
    CMAKE_ARGS
        -DBUILD_SHARED_LIBS=ON
        -DCLANG_INCLUDE_TESTS=OFF
        #-DENABLE_SPIRV_CODEGEN=ON
        -DSPIRV_BUILD_TESTS=OFF
        -DLLVM_APPEND_VC_REV=ON#ON
        -DLLVM_ENABLE_TERMINFO=OFF#ON
        -DLLVM_BUILD_EXAMPLES=OFF
        -DLLVM_INCLUDE_EXAMPLES=OFF
        -DLLVM_BUILD_TESTS=OFF
        -DLLVM_INCLUDE_TESTS=OFF
        -DLLVM_BUILD_DOCS=OFF
        -DLLVM_INCLUDE_DOCS=OFF
        -DLLVM_OPTIMIZED_TABLEGEN=OFF
        -DSPIRV_BUILD_TESTS=OFF
        #-DLLVM_TARGETS_TO_BUILD=X86
        -DCMAKE_INSTALL_PREFIX=<INSTALL_DIR>
        -DCMAKE_DEBUG_POSTFIX=${CMAKE_DEBUG_POSTFIX}
    CMAKE_CACHE_ARGS
        -DLLVM_TARGETS_TO_BUILD:STRING=X86
        -DDXC_BUILD_ARCH:STRING=Win32
        -DLLVM_DEFAULT_TARGET_TRIPLE:STRING=dxil-ms-dx
        -DCLANG_ENABLE_ARCMT:BOOL=OFF
        -DCLANG_ENABLE_STATIC_ANALYZER:BOOL=OFF
        -DLIBCLANG_BUILD_STATIC:BOOL=ON
        -DLLVM_REQUIRES_EH:BOOL=ON
        -DLLVM_ENABLE_RTTI:BOOL=ON
        -DLLVM_ENABLE_EH:BOOL=ON
        -DLLVM_REQUIRES_RTTI:BOOL=ON
        -DCLANG_BUILD_EXAMPLES:BOOL=OFF
        -DCLANG_CL:BOOL=OFF
)

set_property(TARGET ${PROJECT_NAME} PROPERTY FOLDER ${__AE_EXTERNAL_FOLDER_NAME})